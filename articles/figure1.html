<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Figure 1 • CoreMicro</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Figure 1">
<meta property="og:description" content="CoreMicro">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">CoreMicro</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="divider">
    </li>
<li class="dropdown-header">Using CoreMicro</li>
    <li>
      <a href="../articles/analysis_and_plots.html">Analysis and Plots</a>
    </li>
    <li class="divider">
    </li>
<li class="dropdown-header">Manuscript Reproducibility</li>
    <li>
      <a href="../articles/figure1.html">Figure 1</a>
    </li>
    <li>
      <a href="../articles/figure2.html">Figure 2</a>
    </li>
    <li>
      <a href="../articles/figure3.html">Figure 3</a>
    </li>
    <li>
      <a href="../articles/human_figure.html">Figure: Human Venn Diagram</a>
    </li>
    <li>
      <a href="../articles/arabidopsis_figure.html">Figure: Arabidopsis Venn Diagram</a>
    </li>
    <li>
      <a href="../articles/common-counts.html">Common Counts</a>
    </li>
    <li>
      <a href="../articles/co-occurance.html">Human Microbiome Cooccurance</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/MayaGans/CoreMicro/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="figure1_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Figure 1</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/MayaGans/CoreMicro/blob/HEAD/vignettes/figure1.Rmd" class="external-link"><code>vignettes/figure1.Rmd</code></a></small>
      <div class="hidden name"><code>figure1.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mayagans.github.io/CoreMicro/" class="external-link">CoreMicro</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://CRAN.R-project.org/package=MCMCpack" class="external-link">MCMCpack</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">RColorBrewer</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">gridExtra</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com" class="external-link">patchwork</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></code></pre></div>
<div class="section level1">
<h1 id="set-the-structure-of-our-simlulated-taxa-table-not-proritions-of-taxa-just">set the structure of our simlulated taxa table (not proritions of taxa, just<a class="anchor" aria-label="anchor" href="#set-the-structure-of-our-simlulated-taxa-table-not-proritions-of-taxa-just"></a>
</h1>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>rows by columns and expected core<span class="er">)</span></span>
<span id="cb2-2"><a href="#cb2-2"></a>ntaxa&lt;-<span class="dv">1000</span></span>
<span id="cb2-3"><a href="#cb2-3"></a>ncore&lt;-<span class="dv">25</span></span>
<span id="cb2-4"><a href="#cb2-4"></a>nsites&lt;-<span class="dv">50</span></span>
<span id="cb2-5"><a href="#cb2-5"></a>nreads&lt;-<span class="fl">2e06</span></span>
<span id="cb2-6"><a href="#cb2-6"></a>nsims&lt;-<span class="dv">250</span></span>
<span id="cb2-7"><a href="#cb2-7"></a></span>
<span id="cb2-8"><a href="#cb2-8"></a></span>
<span id="cb2-9"><a href="#cb2-9"></a>corenoncoreratio &lt;-<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">10</span>,<span class="dv">25</span>)</span>
<span id="cb2-10"><a href="#cb2-10"></a>p.core &lt;-corenoncoreratio<span class="op">/</span>(ntaxa <span class="op">-</span><span class="st"> </span>ncore <span class="op">+</span><span class="st"> </span>corenoncoreratio<span class="op">*</span>ncore)</span>
<span id="cb2-11"><a href="#cb2-11"></a>p.noncore &lt;-( <span class="dv">1</span><span class="op">-</span>(p.core<span class="op">*</span>ncore) )<span class="op">/</span><span class="st"> </span>(ntaxa <span class="op">-</span><span class="st"> </span>ncore)</span>
<span id="cb2-12"><a href="#cb2-12"></a></span>
<span id="cb2-13"><a href="#cb2-13"></a>theta &lt;-<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">10</span>, <span class="dv">25</span>, <span class="dv">50</span>) <span class="co">#intensity parameter</span></span>
<span id="cb2-14"><a href="#cb2-14"></a></span>
<span id="cb2-15"><a href="#cb2-15"></a></span>
<span id="cb2-16"><a href="#cb2-16"></a><span class="co">## do a set of simulations across input parameter values and number of replicates ------</span></span>
<span id="cb2-17"><a href="#cb2-17"></a><span class="co">## set up the storage of input and output for the 25 simulation conditions</span></span>
<span id="cb2-18"><a href="#cb2-18"></a><span class="co">## quantify TP (true positives) and FP (false positives)</span></span>
<span id="cb2-19"><a href="#cb2-19"></a>sim.df&lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">expand.grid</span>(<span class="dt">corenoncoreratio=</span>corenoncoreratio, <span class="dt">theta=</span>theta), </span>
<span id="cb2-20"><a href="#cb2-20"></a>                    <span class="dt">p.core=</span><span class="kw">rep</span>(p.core, <span class="kw">length</span>(theta)), </span>
<span id="cb2-21"><a href="#cb2-21"></a>                    <span class="dt">p.noncore=</span><span class="kw">rep</span>(p.noncore, <span class="kw">length</span>(theta)),</span>
<span id="cb2-22"><a href="#cb2-22"></a>                    <span class="dt">HardCut_TP=</span> <span class="kw">numeric</span>(<span class="kw">length</span>(p.core) <span class="op">*</span><span class="st"> </span><span class="kw">length</span>(theta)),</span>
<span id="cb2-23"><a href="#cb2-23"></a>                    <span class="dt">PropRead_TP =</span> <span class="kw">numeric</span>(<span class="kw">length</span>(p.core) <span class="op">*</span><span class="st"> </span><span class="kw">length</span>(theta)),</span>
<span id="cb2-24"><a href="#cb2-24"></a>                    <span class="dt">PropReps_TP =</span> <span class="kw">numeric</span>(<span class="kw">length</span>(p.core) <span class="op">*</span><span class="st"> </span><span class="kw">length</span>(theta)),</span>
<span id="cb2-25"><a href="#cb2-25"></a>                    <span class="dt">PropReadReps_TP =</span> <span class="kw">numeric</span>(<span class="kw">length</span>(p.core) <span class="op">*</span><span class="st"> </span><span class="kw">length</span>(theta)),</span>
<span id="cb2-26"><a href="#cb2-26"></a>                    <span class="dt">HardCut_FP=</span> <span class="kw">numeric</span>(<span class="kw">length</span>(p.core) <span class="op">*</span><span class="st"> </span><span class="kw">length</span>(theta)),</span>
<span id="cb2-27"><a href="#cb2-27"></a>                    <span class="dt">PropRead_FP =</span> <span class="kw">numeric</span>(<span class="kw">length</span>(p.core) <span class="op">*</span><span class="st"> </span><span class="kw">length</span>(theta)),</span>
<span id="cb2-28"><a href="#cb2-28"></a>                    <span class="dt">PropReps_FP =</span> <span class="kw">numeric</span>(<span class="kw">length</span>(p.core) <span class="op">*</span><span class="st"> </span><span class="kw">length</span>(theta)),</span>
<span id="cb2-29"><a href="#cb2-29"></a>                    <span class="dt">PropReadReps_FP =</span> <span class="kw">numeric</span>(<span class="kw">length</span>(p.core) <span class="op">*</span><span class="st"> </span><span class="kw">length</span>(theta)),</span>
<span id="cb2-30"><a href="#cb2-30"></a>                    <span class="dt">HardCut_FP_num=</span> <span class="kw">numeric</span>(<span class="kw">length</span>(p.core) <span class="op">*</span><span class="st"> </span><span class="kw">length</span>(theta)),</span>
<span id="cb2-31"><a href="#cb2-31"></a>                    <span class="dt">PropRead_FP_num =</span> <span class="kw">numeric</span>(<span class="kw">length</span>(p.core) <span class="op">*</span><span class="st"> </span><span class="kw">length</span>(theta)),</span>
<span id="cb2-32"><a href="#cb2-32"></a>                    <span class="dt">PropReps_FP_num =</span> <span class="kw">numeric</span>(<span class="kw">length</span>(p.core) <span class="op">*</span><span class="st"> </span><span class="kw">length</span>(theta)),</span>
<span id="cb2-33"><a href="#cb2-33"></a>                    <span class="dt">PropReadReps_FP_num =</span> <span class="kw">numeric</span>(<span class="kw">length</span>(p.core) <span class="op">*</span><span class="st"> </span><span class="kw">length</span>(theta)),</span>
<span id="cb2-34"><a href="#cb2-34"></a>                    <span class="dt">HardCut_TP_num=</span> <span class="kw">numeric</span>(<span class="kw">length</span>(p.core) <span class="op">*</span><span class="st"> </span><span class="kw">length</span>(theta)),</span>
<span id="cb2-35"><a href="#cb2-35"></a>                    <span class="dt">PropRead_TP_num =</span> <span class="kw">numeric</span>(<span class="kw">length</span>(p.core) <span class="op">*</span><span class="st"> </span><span class="kw">length</span>(theta)),</span>
<span id="cb2-36"><a href="#cb2-36"></a>                    <span class="dt">PropReps_TP_num =</span> <span class="kw">numeric</span>(<span class="kw">length</span>(p.core) <span class="op">*</span><span class="st"> </span><span class="kw">length</span>(theta)),</span>
<span id="cb2-37"><a href="#cb2-37"></a>                    <span class="dt">PropReadReps_TP_num =</span> <span class="kw">numeric</span>(<span class="kw">length</span>(p.core) <span class="op">*</span><span class="st"> </span><span class="kw">length</span>(theta))</span>
<span id="cb2-38"><a href="#cb2-38"></a>)</span>
<span id="cb2-39"><a href="#cb2-39"></a></span>
<span id="cb2-40"><a href="#cb2-40"></a><span class="co">#error2.5 = numeric(length(p.core) * length(theta)),</span></span>
<span id="cb2-41"><a href="#cb2-41"></a><span class="co">#error97.5 = numeric(length(p.core) * length(theta)))</span></span>
<span id="cb2-42"><a href="#cb2-42"></a><span class="co">#sim.df</span></span>
<span id="cb2-43"><a href="#cb2-43"></a></span>
<span id="cb2-44"><a href="#cb2-44"></a><span class="cf">for</span>(trt <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>(<span class="kw">nrow</span>(sim.df))){</span>
<span id="cb2-45"><a href="#cb2-45"></a>  </span>
<span id="cb2-46"><a href="#cb2-46"></a>  <span class="co"># create empty vectors to store output for each method for every simulation</span></span>
<span id="cb2-47"><a href="#cb2-47"></a>  tmp.err.HardCutTP &lt;-<span class="st">  </span><span class="kw">numeric</span>(nsims)</span>
<span id="cb2-48"><a href="#cb2-48"></a>  tmp.err.PropReadTP &lt;-<span class="st"> </span><span class="kw">numeric</span>(nsims)</span>
<span id="cb2-49"><a href="#cb2-49"></a>  tmp.err.PropRepsTP &lt;-<span class="st"> </span><span class="kw">numeric</span>(nsims)</span>
<span id="cb2-50"><a href="#cb2-50"></a>  tmp.err.PropReadRepsTP &lt;-<span class="st"> </span><span class="kw">numeric</span>(nsims)</span>
<span id="cb2-51"><a href="#cb2-51"></a>  tmp.err.HardCutFP &lt;-<span class="st">  </span><span class="kw">numeric</span>(nsims)</span>
<span id="cb2-52"><a href="#cb2-52"></a>  tmp.err.PropReadFP &lt;-<span class="st"> </span><span class="kw">numeric</span>(nsims)</span>
<span id="cb2-53"><a href="#cb2-53"></a>  tmp.err.PropRepsFP &lt;-<span class="st"> </span><span class="kw">numeric</span>(nsims)</span>
<span id="cb2-54"><a href="#cb2-54"></a>  tmp.err.PropReadRepsFP &lt;-<span class="st"> </span><span class="kw">numeric</span>(nsims)</span>
<span id="cb2-55"><a href="#cb2-55"></a>  <span class="co">#tmp.err.HardCutTP_num &lt;-  numeric(nsims)</span></span>
<span id="cb2-56"><a href="#cb2-56"></a>  <span class="co">#tmp.err.PropReadTP_num &lt;- numeric(nsims)</span></span>
<span id="cb2-57"><a href="#cb2-57"></a>  <span class="co">#tmp.err.PropRepsTP_num &lt;- numeric(nsims)</span></span>
<span id="cb2-58"><a href="#cb2-58"></a>  <span class="co">#tmp.err.PropReadRepsTP_num &lt;- numeric(nsims)</span></span>
<span id="cb2-59"><a href="#cb2-59"></a>  <span class="co">#tmp.err.HardCutFP_num &lt;-  numeric(nsims)</span></span>
<span id="cb2-60"><a href="#cb2-60"></a>  <span class="co">#tmp.err.PropReadFP_num &lt;- numeric(nsims)</span></span>
<span id="cb2-61"><a href="#cb2-61"></a>  <span class="co">#tmp.err.PropRepsFP_num &lt;- numeric(nsims)</span></span>
<span id="cb2-62"><a href="#cb2-62"></a>  <span class="co">#tmp.err.PropReadRepsFP_num &lt;- numeric(nsims)</span></span>
<span id="cb2-63"><a href="#cb2-63"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>nsims){</span>
<span id="cb2-64"><a href="#cb2-64"></a>    <span class="co"># create a single OTU table for all four methods to be compared against</span></span>
<span id="cb2-65"><a href="#cb2-65"></a>    replicateSim &lt;-<span class="st"> </span><span class="kw">round</span>(<span class="kw">rdirichlet</span>(nsites, <span class="kw">c</span>(<span class="kw">rep</span>(sim.df<span class="op">$</span>p.core[trt] <span class="op">*</span><span class="st"> </span>sim.df<span class="op">$</span>theta[trt], ncore), </span>
<span id="cb2-66"><a href="#cb2-66"></a>                                               <span class="kw">rep</span>(sim.df<span class="op">$</span>p.noncore[trt] <span class="op">*</span><span class="st"> </span>sim.df<span class="op">$</span>theta[trt], ntaxa<span class="op">-</span>ncore))) <span class="op">*</span><span class="st"> </span>nreads)</span>
<span id="cb2-67"><a href="#cb2-67"></a>    </span>
<span id="cb2-68"><a href="#cb2-68"></a>    <span class="co"># find true and false positives</span></span>
<span id="cb2-69"><a href="#cb2-69"></a>    <span class="co"># true positives are those that meet in the criterion in the first 1:ncore taxa.  The remaining taxa are not part of the core, so any taxa meeting the criterion in that set are false positives</span></span>
<span id="cb2-70"><a href="#cb2-70"></a>    </span>
<span id="cb2-71"><a href="#cb2-71"></a>    <span class="co"># hard cut off method</span></span>
<span id="cb2-72"><a href="#cb2-72"></a>    <span class="co"># tmp.err.HardCut[i] &lt;-  sum(colSums((replicateSim &gt;= 25)) &gt;= 5) - ncore</span></span>
<span id="cb2-73"><a href="#cb2-73"></a>    tmp.err.HardCutTP[i] &lt;-<span class="st">  </span><span class="kw">sum</span>((<span class="kw">colSums</span>((replicateSim <span class="op">&gt;=</span><span class="st"> </span><span class="dv">25</span>)) <span class="op">&gt;=</span><span class="st"> </span><span class="dv">5</span>)[<span class="dv">1</span><span class="op">:</span>ncore])</span>
<span id="cb2-74"><a href="#cb2-74"></a>    tmp.err.HardCutFP[i] &lt;-<span class="st">  </span><span class="kw">sum</span>((<span class="kw">colSums</span>((replicateSim <span class="op">&gt;=</span><span class="st"> </span><span class="dv">25</span>)) <span class="op">&gt;=</span><span class="st"> </span><span class="dv">5</span>)[(ncore<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>ntaxa])</span>
<span id="cb2-75"><a href="#cb2-75"></a>    </span>
<span id="cb2-76"><a href="#cb2-76"></a>    <span class="co"># Prop reads</span></span>
<span id="cb2-77"><a href="#cb2-77"></a>    <span class="co">#tmp.err.PropRead[i] &lt;- sum(cumsum(sort(colSums(replicateSim)/sum(rowSums(replicateSim))))&gt;=0.25)  - ncore</span></span>
<span id="cb2-78"><a href="#cb2-78"></a>    tmp.err.PropReadTP[i] &lt;-<span class="st"> </span><span class="kw">sum</span>((<span class="kw">cumsum</span>(<span class="kw">sort</span>(<span class="kw">colSums</span>(replicateSim)<span class="op">/</span><span class="kw">sum</span>(<span class="kw">rowSums</span>(replicateSim)), <span class="dt">decreasing =</span> T))<span class="op">&lt;=</span><span class="st"> </span><span class="fl">0.75</span>)[<span class="dv">1</span><span class="op">:</span>ncore])</span>
<span id="cb2-79"><a href="#cb2-79"></a>    tmp.err.PropReadFP[i] &lt;-<span class="st"> </span><span class="kw">sum</span>((<span class="kw">cumsum</span>(<span class="kw">sort</span>(<span class="kw">colSums</span>(replicateSim)<span class="op">/</span><span class="kw">sum</span>(<span class="kw">rowSums</span>(replicateSim)), <span class="dt">decreasing =</span> T))<span class="op">&lt;=</span><span class="st"> </span><span class="fl">0.75</span>)[(ncore<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>ntaxa])  </span>
<span id="cb2-80"><a href="#cb2-80"></a>    </span>
<span id="cb2-81"><a href="#cb2-81"></a>    <span class="co"># Prop Reps</span></span>
<span id="cb2-82"><a href="#cb2-82"></a>    <span class="co">#tmp.err.PropReps[i] &lt;- sum(colSums(replicateSim)&gt;10*nrow(replicateSim))  - ncore</span></span>
<span id="cb2-83"><a href="#cb2-83"></a>    <span class="co">#Sites in rows, otus in Columns</span></span>
<span id="cb2-84"><a href="#cb2-84"></a>    tmp.err.PropRepsTP[i] &lt;-<span class="st"> </span><span class="kw">sum</span>((<span class="kw">colSums</span>(replicateSim<span class="op">&gt;</span><span class="dv">0</span>) <span class="op">&gt;=</span><span class="st"> </span>(<span class="fl">0.5</span> <span class="op">*</span><span class="st"> </span>nsites))[<span class="dv">1</span><span class="op">:</span>ncore])  </span>
<span id="cb2-85"><a href="#cb2-85"></a>    tmp.err.PropRepsFP[i] &lt;-<span class="st"> </span><span class="kw">sum</span>((<span class="kw">colSums</span>(replicateSim<span class="op">&gt;</span><span class="dv">0</span>) <span class="op">&gt;=</span><span class="st"> </span>(<span class="fl">0.5</span> <span class="op">*</span><span class="st"> </span>nsites))[(ncore<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>ntaxa])   </span>
<span id="cb2-86"><a href="#cb2-86"></a>    </span>
<span id="cb2-87"><a href="#cb2-87"></a>    <span class="co"># Proportion of reps and reads</span></span>
<span id="cb2-88"><a href="#cb2-88"></a>    <span class="co">#tmp.err.PropReadReps[i] &lt;- sum((colSums(replicateSim&gt;0) &gt;= (0.5 * nsites)) &amp; (colSums(replicateSim) &gt;= sum(replicateSim) * 1/1000) )  - ncore</span></span>
<span id="cb2-89"><a href="#cb2-89"></a>    tmp.err.PropReadRepsTP[i] &lt;-<span class="st"> </span><span class="kw">sum</span>(((<span class="kw">colSums</span>(replicateSim<span class="op">&gt;</span><span class="dv">0</span>) <span class="op">&gt;=</span><span class="st"> </span>(<span class="fl">0.5</span> <span class="op">*</span><span class="st"> </span>nsites)) <span class="op">&amp;</span><span class="st"> </span>(<span class="kw">colSums</span>(replicateSim) <span class="op">&gt;=</span><span class="st"> </span><span class="kw">sum</span>(replicateSim) <span class="op">*</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span><span class="dv">1000</span>) )[<span class="dv">1</span><span class="op">:</span>ncore]) </span>
<span id="cb2-90"><a href="#cb2-90"></a>    tmp.err.PropReadRepsFP[i] &lt;-<span class="st"> </span><span class="kw">sum</span>(((<span class="kw">colSums</span>(replicateSim<span class="op">&gt;</span><span class="dv">0</span>) <span class="op">&gt;=</span><span class="st"> </span>(<span class="fl">0.5</span> <span class="op">*</span><span class="st"> </span>nsites)) <span class="op">&amp;</span><span class="st"> </span>(<span class="kw">colSums</span>(replicateSim) <span class="op">&gt;=</span><span class="st"> </span><span class="kw">sum</span>(replicateSim) <span class="op">*</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span><span class="dv">1000</span>) )[(ncore<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>ntaxa]) </span>
<span id="cb2-91"><a href="#cb2-91"></a>  }</span>
<span id="cb2-92"><a href="#cb2-92"></a>  </span>
<span id="cb2-93"><a href="#cb2-93"></a>  <span class="co"># fill the dataframe from the chunk above with these values for later plotting</span></span>
<span id="cb2-94"><a href="#cb2-94"></a>  sim.df<span class="op">$</span>HardCut_TP[trt] &lt;-<span class="st"> </span><span class="kw">mean</span>(tmp.err.HardCutTP) <span class="op">/</span><span class="st"> </span>ncore</span>
<span id="cb2-95"><a href="#cb2-95"></a>  sim.df<span class="op">$</span>PropRead_TP[trt] &lt;-<span class="st"> </span><span class="kw">mean</span>(tmp.err.PropReadTP) <span class="op">/</span><span class="st"> </span>ncore</span>
<span id="cb2-96"><a href="#cb2-96"></a>  sim.df<span class="op">$</span>PropReps_TP[trt] &lt;-<span class="st"> </span><span class="kw">mean</span>(tmp.err.PropRepsTP) <span class="op">/</span><span class="st"> </span>ncore</span>
<span id="cb2-97"><a href="#cb2-97"></a>  sim.df<span class="op">$</span>PropReadReps_TP[trt] &lt;-<span class="st"> </span><span class="kw">mean</span>(tmp.err.PropReadRepsTP) <span class="op">/</span><span class="st"> </span>ncore</span>
<span id="cb2-98"><a href="#cb2-98"></a>  </span>
<span id="cb2-99"><a href="#cb2-99"></a>  sim.df<span class="op">$</span>HardCut_FP[trt] &lt;-<span class="st"> </span><span class="kw">mean</span>(tmp.err.HardCutFP) <span class="op">/</span><span class="st"> </span>(ntaxa <span class="op">-</span><span class="st"> </span>ncore)</span>
<span id="cb2-100"><a href="#cb2-100"></a>  sim.df<span class="op">$</span>PropRead_FP[trt] &lt;-<span class="st"> </span><span class="kw">mean</span>(tmp.err.PropReadFP) <span class="op">/</span><span class="st"> </span>(ntaxa <span class="op">-</span><span class="st"> </span>ncore)</span>
<span id="cb2-101"><a href="#cb2-101"></a>  sim.df<span class="op">$</span>PropReps_FP[trt] &lt;-<span class="st"> </span><span class="kw">mean</span>(tmp.err.PropRepsFP) <span class="op">/</span><span class="st"> </span>(ntaxa <span class="op">-</span><span class="st"> </span>ncore)</span>
<span id="cb2-102"><a href="#cb2-102"></a>  sim.df<span class="op">$</span>PropReadReps_FP[trt] &lt;-<span class="st"> </span><span class="kw">mean</span>(tmp.err.PropReadRepsFP) <span class="op">/</span><span class="st"> </span>(ntaxa <span class="op">-</span><span class="st"> </span>ncore)</span>
<span id="cb2-103"><a href="#cb2-103"></a>  </span>
<span id="cb2-104"><a href="#cb2-104"></a>  sim.df<span class="op">$</span>HardCut_TP_num[trt] &lt;-<span class="st"> </span><span class="kw">mean</span>(tmp.err.HardCutTP) </span>
<span id="cb2-105"><a href="#cb2-105"></a>  sim.df<span class="op">$</span>PropRead_TP_num[trt] &lt;-<span class="st"> </span><span class="kw">mean</span>(tmp.err.PropReadTP) </span>
<span id="cb2-106"><a href="#cb2-106"></a>  sim.df<span class="op">$</span>PropReps_TP_num[trt] &lt;-<span class="st"> </span><span class="kw">mean</span>(tmp.err.PropRepsTP) </span>
<span id="cb2-107"><a href="#cb2-107"></a>  sim.df<span class="op">$</span>PropReadReps_TP_num[trt] &lt;-<span class="st"> </span><span class="kw">mean</span>(tmp.err.PropReadRepsTP) </span>
<span id="cb2-108"><a href="#cb2-108"></a>  </span>
<span id="cb2-109"><a href="#cb2-109"></a>  sim.df<span class="op">$</span>HardCut_FP_num[trt] &lt;-<span class="st"> </span><span class="kw">mean</span>(tmp.err.HardCutFP) </span>
<span id="cb2-110"><a href="#cb2-110"></a>  sim.df<span class="op">$</span>PropRead_FP_num[trt] &lt;-<span class="st"> </span><span class="kw">mean</span>(tmp.err.PropReadFP) </span>
<span id="cb2-111"><a href="#cb2-111"></a>  sim.df<span class="op">$</span>PropReps_FP_num[trt] &lt;-<span class="st"> </span><span class="kw">mean</span>(tmp.err.PropRepsFP) </span>
<span id="cb2-112"><a href="#cb2-112"></a>  sim.df<span class="op">$</span>PropReadReps_FP_num[trt] &lt;-<span class="st"> </span><span class="kw">mean</span>(tmp.err.PropReadRepsFP)</span>
<span id="cb2-113"><a href="#cb2-113"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">myPalette</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#800000"</span>, <span class="st">"#A04040"</span>, <span class="st">"#DFBFBF"</span>, <span class="st">"#ffffff"</span>, <span class="st">"#0b45a3"</span><span class="op">)</span>
<span class="va">myPalette2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#ffffff"</span>, <span class="st">"#C2D1E8"</span>, <span class="st">"#678BC6"</span>, <span class="st">"#0b45a3"</span><span class="op">)</span>
<span class="va">myPalette3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#ffffff"</span>, <span class="st">"#C2D1E8"</span><span class="op">)</span></code></pre></div>
<p>Here we change the TP-FP to an integer not the ratio. With the ratios we were assuming all calls TP vs.  FP were equally valuable. With this we just look at the differencea and make no assumiption of the value.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sim.df</span><span class="op">$</span><span class="va">HardCut_ratio</span> <span class="op">&lt;-</span> <span class="va">sim.df</span><span class="op">$</span><span class="va">HardCut_TP_num</span> <span class="op">-</span> <span class="va">sim.df</span><span class="op">$</span><span class="va">HardCut_FP_num</span>
<span class="va">sim.df</span><span class="op">$</span><span class="va">PropRead_ratio</span> <span class="op">&lt;-</span> <span class="va">sim.df</span><span class="op">$</span><span class="va">PropRead_TP_num</span> <span class="op">-</span> <span class="va">sim.df</span><span class="op">$</span><span class="va">PropRead_FP_num</span>
<span class="va">sim.df</span><span class="op">$</span><span class="va">PropReps_ratio</span> <span class="op">&lt;-</span> <span class="va">sim.df</span><span class="op">$</span><span class="va">PropReps_TP_num</span> <span class="op">-</span> <span class="va">sim.df</span><span class="op">$</span><span class="va">PropReps_FP_num</span>
<span class="va">sim.df</span><span class="op">$</span><span class="va">PropReadReps_ratio</span> <span class="op">&lt;-</span> <span class="va">sim.df</span><span class="op">$</span><span class="va">PropReadReps_TP_num</span> <span class="op">-</span> <span class="va">sim.df</span><span class="op">$</span><span class="va">PropReadReps_FP_num</span>

<span class="va">sim.df_all</span> <span class="op">&lt;-</span> <span class="va">sim.df</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">gather</span><span class="op">(</span><span class="va">method</span>, <span class="va">mean</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span><span class="op">:</span><span class="fl">8</span>, <span class="fl">9</span><span class="op">:</span><span class="fl">12</span>, <span class="fl">21</span><span class="op">:</span><span class="fl">24</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">separate</span><span class="op">(</span><span class="va">method</span>, into <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'method'</span>, <span class="st">'error'</span><span class="op">)</span>, sep <span class="op">=</span> <span class="st">"_"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">mutate</span><span class="op">(</span>error <span class="op">=</span>
           <span class="fu">case_when</span><span class="op">(</span>
             <span class="va">error</span> <span class="op">==</span> <span class="st">"TP"</span> <span class="op">~</span> <span class="st">"True Positive"</span>,
             <span class="va">error</span> <span class="op">==</span> <span class="st">"FP"</span> <span class="op">~</span> <span class="st">"False Positive"</span>,
             <span class="va">error</span> <span class="op">==</span> <span class="st">"ratio"</span> <span class="op">~</span> <span class="st">"TP-FP"</span>
           <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
           <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span>levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"True Positive"</span>, <span class="st">"False Positive"</span>, <span class="st">"TP-FP"</span><span class="op">)</span><span class="op">)</span>
  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">mutate</span><span class="op">(</span>method <span class="op">=</span>
           <span class="fu">case_when</span><span class="op">(</span>
             <span class="va">method</span> <span class="op">==</span> <span class="st">"HardCut"</span> <span class="op">~</span> <span class="st">"Hard Cutoff"</span>,
             <span class="va">method</span> <span class="op">==</span> <span class="st">"PropRead"</span> <span class="op">~</span> <span class="st">"Summation Sequence Reads"</span>,
             <span class="va">method</span> <span class="op">==</span> <span class="st">"PropReps"</span> <span class="op">~</span> <span class="st">"Proportion of Sequence Replicates"</span>,
             <span class="va">method</span> <span class="op">==</span> <span class="st">"PropReadReps"</span> <span class="op">~</span> <span class="st">"Proportion of Sequence Reads and Replicates"</span>
           <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
           <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span>levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Summation Sequence Reads"</span>, <span class="st">"Proportion of Sequence Replicates"</span>, <span class="st">"Proportion of Sequence Reads and Replicates"</span>, <span class="st">"Hard Cutoff"</span><span class="op">)</span><span class="op">)</span>
  <span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tp</span> <span class="op">&lt;-</span> <span class="va">sim.df_all</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">sim.df_all</span><span class="op">$</span><span class="va">error</span> <span class="op">==</span> <span class="st">"True Positive"</span><span class="op">)</span>

<span class="va">tp_plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">tp</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">corenoncoreratio</span><span class="op">)</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">theta</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_tile</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">mean</span><span class="op">)</span>, colour <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="va">error</span><span class="op">~</span><span class="va">method</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.text<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html" class="external-link">scale_fill_gradientn</a></span><span class="op">(</span>colours <span class="op">=</span> <span class="va">myPalette2</span>, values <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/rescale.html" class="external-link">rescale</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1000</span>, <span class="op">-</span><span class="fl">500</span>, <span class="op">-</span><span class="fl">25</span>,<span class="fl">0</span>, <span class="fl">100</span>, <span class="fl">500</span>, <span class="fl">1000</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_text</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">mean</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"("</span>, <span class="va">pi</span>, <span class="st">" core / "</span>, <span class="va">pi</span>, <span class="st">" non-core)"</span><span class="op">)</span><span class="op">)</span>,
       y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">theta</span><span class="op">)</span><span class="op">)</span>,
       fill <span class="op">=</span> <span class="st">"Mean Error"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>strip.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">15</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.title.x<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,
        axis.text.x<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,
        axis.ticks.x<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">20</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html" class="external-link">guides</a></span><span class="op">(</span>fill<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html" class="external-link">guide_legend</a></span><span class="op">(</span>title<span class="op">=</span><span class="st">"Proportion of\nTrue Positives"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fp</span> <span class="op">&lt;-</span> <span class="va">sim.df_all</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">sim.df_all</span><span class="op">$</span><span class="va">error</span> <span class="op">==</span> <span class="st">"False Positive"</span><span class="op">)</span>

<span class="va">fp_plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">fp</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">corenoncoreratio</span><span class="op">)</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">theta</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_tile</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">mean</span><span class="op">)</span>, colour <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="va">error</span><span class="op">~</span><span class="va">method</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.text<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html" class="external-link">scale_fill_gradientn</a></span><span class="op">(</span>colours <span class="op">=</span> <span class="va">myPalette2</span>, values <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/rescale.html" class="external-link">rescale</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1000</span>, <span class="fl">500</span>, <span class="fl">25</span>,<span class="fl">0</span>, <span class="op">-</span><span class="fl">100</span>, <span class="op">-</span><span class="fl">500</span>, <span class="op">-</span><span class="fl">1000</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_text</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">fp</span><span class="op">$</span><span class="va">mean</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"("</span>, <span class="va">pi</span>, <span class="st">" core / "</span>, <span class="va">pi</span>, <span class="st">" non-core)"</span><span class="op">)</span><span class="op">)</span>,
       y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">theta</span><span class="op">)</span><span class="op">)</span>,
       fill <span class="op">=</span> <span class="st">"Mean Error"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>strip.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.title.x<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,
        axis.text.x<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,
        axis.ticks.x<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">20</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html" class="external-link">guides</a></span><span class="op">(</span>fill<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html" class="external-link">guide_legend</a></span><span class="op">(</span>title<span class="op">=</span><span class="st">"Proportion of\nFalse Positives"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tf</span> <span class="op">&lt;-</span> <span class="va">sim.df_all</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">sim.df_all</span><span class="op">$</span><span class="va">error</span> <span class="op">==</span> <span class="st">"TP-FP"</span><span class="op">)</span>

<span class="va">breaks</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">900</span>, <span class="op">-</span><span class="fl">400</span>, <span class="fl">0</span>, <span class="fl">25</span><span class="op">)</span>

<span class="va">tf_plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">tf</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">corenoncoreratio</span><span class="op">)</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">theta</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_tile</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">mean</span><span class="op">)</span>, colour <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="va">error</span><span class="op">~</span><span class="va">method</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.text<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html" class="external-link">scale_fill_gradientn</a></span><span class="op">(</span>colours <span class="op">=</span> <span class="va">myPalette</span>, breaks <span class="op">=</span> <span class="va">breaks</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_text</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">tf</span><span class="op">$</span><span class="va">mean</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"("</span>, <span class="va">pi</span>, <span class="st">" core / "</span>, <span class="va">pi</span>, <span class="st">" non-core)"</span><span class="op">)</span><span class="op">)</span>,
       y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">theta</span><span class="op">)</span><span class="op">)</span>,
       fill <span class="op">=</span> <span class="st">"Mean Error"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>strip.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">20</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html" class="external-link">guides</a></span><span class="op">(</span>fill<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html" class="external-link">guide_legend</a></span><span class="op">(</span>title<span class="op">=</span><span class="st">"TP-FP"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">g</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">tp_plot</span> <span class="op">+</span> <span class="va">fp_plot</span> <span class="op">+</span> <span class="va">tf_plot</span> <span class="op">+</span> <span class="fu">plot_layout</span><span class="op">(</span>ncol<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span> <span class="fu">plot_annotation</span><span class="op">(</span>tag_levels <span class="op">=</span> <span class="st">'A'</span><span class="op">)</span><span class="op">)</span>

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html" class="external-link">ggsave</a></span><span class="op">(</span><span class="st">"inst/figures/figure1.tiff"</span>, <span class="va">g</span>, height <span class="op">=</span> <span class="fl">12</span>, width <span class="op">=</span> <span class="fl">23</span><span class="op">)</span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Maya Gans, Gordon Custer.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.1.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
